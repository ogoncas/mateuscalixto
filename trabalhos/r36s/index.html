<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R36S Hub | Comunidade Retro</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800&family=Press+Start+2P&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/phosphor-icons"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <meta name="description" content="Explore uma vasta cole√ß√£o de temas, tutoriais e firmwares para R36S. Contribua com seus pr√≥prios projetos e fa√ßa parte da comunidade R36S!">
    <meta name="author" content="Mateus Calixto">
    <link rel="canonical" href="https://mateuscalixto.com.br/trabalhos/r36s">

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://mateuscalixto.com.br/trabalhos/r36s">
    <meta property="og:title" content="R36S Hub | Comunidade Retro">
    <meta property="og:description" content="Explore uma vasta cole√ß√£o de temas, tutoriais e firmwares para R36S. Contribua com seus pr√≥prios projetos e fa√ßa parte da comunidade R36S!">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="R36S Hub | Comunidade Retro">
    <meta name="twitter:description" content="Explore uma vasta cole√ß√£o de temas, tutoriais e firmwares para R36S. Contribua com seus pr√≥prios projetos e fa√ßa parte da comunidade R36S!">
    
</head>

<style>
    /* ==========================================================================
    VARI√ÅREIS E DEFINI√á√ïES GLOBAIS - APRIMORADAS PARA DESIGN MODERNO
    ========================================================================== */
    :root {
        --bg-color: #0a0a0f;
        --card-bg: rgba(20, 25, 35, 0.85);
        --primary: #7c3aed;
        --primary-glow: rgba(124, 58, 237, 0.15);
        --secondary: #06b6d4;
        --text-main: #f9fafb;
        --text-muted: #9ca3af;
        --border: rgba(255, 255, 255, 0.1);
        --radius: 20px;
        --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        --shadow-sm: 0 4px 6px rgba(0, 0, 0, 0.1);
        --shadow-md: 0 10px 15px rgba(0, 0, 0, 0.2);
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    html {
        scroll-behavior: smooth;
    }

    body {
        background: var(--bg-color);
        background-image: 
            radial-gradient(circle at 10% 20%, rgba(124, 58, 237, 0.05) 0%, transparent 50%),
            radial-gradient(circle at 90% 80%, rgba(6, 182, 212, 0.03) 0%, transparent 50%);
        color: var(--text-main);
        font-family: 'Inter', sans-serif;
        line-height: 1.7;
        min-height: 100vh;
        overflow-x: hidden;
        display: flex;
        flex-direction: column;
    }

    main { flex: 1; }

    /* Scrollbar Customizada - Mais fluida */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: var(--text-muted); border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--primary); }

    /* ==========================================================================
    TIPOGRAFIA E UTILIT√ÅRIOS - APRIMORADOS PARA PROFISSIONALISMO
    ========================================================================== */
    h1, h2, h3 { font-weight: 700; letter-spacing: -0.025em; }
    h1 { font-size: clamp(2.5rem, 6vw, 4rem); line-height: 1.05; }
    h2 { font-size: clamp(1.5rem, 4vw, 2.25rem); }
    h3 { font-size: 1.25rem; }

    .pixel-font { 
        font-family: 'Press Start 2P', cursive; 
        font-size: 0.8rem; 
        color: var(--secondary); 
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    .gradient-text {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .container {
        max-width: 1280px;
        margin: 0 auto;
        padding: 0 1.5rem;
    }

    /* ==========================================================================
    NAVEGA√á√ÉO (NAVBAR) - MAIS MODERNA E FLUIDA
    ========================================================================== */
    .navbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem 5%;
        background: rgba(10, 10, 15, 0.95);
        backdrop-filter: blur(20px) saturate(150%);
        border-bottom: 1px solid var(--border);
        position: sticky;
        top: 0;
        z-index: 1000;
        box-shadow: var(--shadow-sm);
        transition: background 0.3s ease;
    }

    .logo {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 1.25rem;
        font-weight: 600;
        letter-spacing: -0.05em;
        color: var(--text-main);
        transition: transform 0.3s ease;
    }

    .logo:hover { transform: scale(1.05); }

    .logo::before {
        content: 'üïπÔ∏è';
        font-size: 1.4rem;
    }

    .nav-links {
        display: flex;
        gap: 2rem;
        list-style: none;
    }

    .nav-links a {
        color: var(--text-muted);
        text-decoration: none;
        font-weight: 500;
        font-size: 0.95rem;
        position: relative;
        transition: var(--transition);
    }

    .nav-links a:hover, .nav-links a.active {
        color: var(--text-main);
    }

    .nav-links a::after {
        content: '';
        position: absolute;
        bottom: -6px;
        left: 0;
        width: 0;
        height: 2px;
        background: var(--primary);
        transition: width 0.3s ease;
    }

    .nav-links a:hover::after, .nav-links a.active::after {
        width: 100%;
    }

    /* Hamburger Menu - Animado */
    .hamburger {
        display: none;
        cursor: pointer;
        flex-direction: column;
        gap: 4px;
        transition: var(--transition);
    }

    .hamburger span {
        width: 24px;
        height: 2px;
        background: var(--text-main);
        border-radius: 2px;
        transition: 0.3s ease;
    }

    .hamburger.active span:nth-child(1) { transform: rotate(45deg) translate(5px, 5px); }
    .hamburger.active span:nth-child(2) { opacity: 0; }
    .hamburger.active span:nth-child(3) { transform: rotate(-45deg) translate(7px, -6px); }

    @media (max-width: 768px) {
        .hamburger { display: flex; }
        .nav-links { 
            display: none; 
            flex-direction: column; 
            position: absolute; 
            top: 60px; 
            left: 0; 
            width: 100%; 
            background: rgba(10, 10, 15, 0.95); 
            padding: 1.5rem 0; 
            border-bottom: 1px solid var(--border);
            gap: 1.5rem;
            align-items: center;
            animation: slideDown 0.3s ease-out;
        }
        .nav-links.active { display: flex; }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
    }

    /* ==========================================================================
    HERO E BUSCA - MAIS POLIDA
    ========================================================================== */
    .hero {
        text-align: center;
        padding: 6rem 1rem 4rem;
        animation: fadeInUp 1s ease-out;
    }

    @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    .hero p {
        color: var(--text-muted);
        margin-top: 1rem;
        font-size: 1.15rem;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
    }

    .search-bar {
        background: rgba(255, 255, 255, 0.04);
        border: 1px solid var(--border);
        border-radius: 50px;
        padding: 0.75rem 1.75rem;
        display: flex;
        align-items: center;
        gap: 10px;
        max-width: 600px;
        margin: 2.5rem auto 0;
        transition: var(--transition);
        box-shadow: var(--shadow-sm);
    }

    .search-bar:focus-within {
        border-color: var(--primary);
        box-shadow: 0 0 0 3px var(--primary-glow), var(--shadow-md);
        background: rgba(255, 255, 255, 0.06);
    }

    .search-bar input {
        background: transparent;
        border: none;
        color: var(--text-main);
        width: 100%;
        outline: none;
        font-size: 1rem;
        transition: color 0.3s ease;
    }

    .search-bar input::placeholder { color: var(--text-muted); }

    /* ==========================================================================
    FILTROS E CHIPS - MAIS FLUIDOS
    ========================================================================== */
    .filters {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-bottom: 3rem;
        flex-wrap: wrap;
    }

    .filter-chip {
        background: rgba(255, 255, 255, 0.02);
        border: 1px solid var(--border);
        color: var(--text-muted);
        padding: 0.5rem 1.25rem;
        border-radius: 50px;
        cursor: pointer;
        font-weight: 500;
        font-size: 0.85rem;
        transition: var(--transition);
        display: flex;
        align-items: center;
        gap: 6px;
    }

    .filter-chip:hover {
        background: rgba(255, 255, 255, 0.06);
        color: var(--text-main);
        box-shadow: var(--shadow-sm);
    }

    .filter-chip.active {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        color: white;
        border-color: transparent;
        box-shadow: 0 4px 12px var(--primary-glow);
    }

    /* ==========================================================================
    GRID DE CONTE√öDO E CARDS - MAIS MODERNOS
    ========================================================================== */
    .content-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: 1.5rem;
        padding-bottom: 5rem;
    }

    .card {
        background: var(--card-bg);
        border-radius: var(--radius);
        border: 1px solid var(--border);
        overflow: hidden;
        cursor: pointer;
        transition: var(--transition);
        position: relative;
        backdrop-filter: blur(8px);
        box-shadow: var(--shadow-sm);
    }

    .card:hover {
        transform: translateY(-8px);
        border-color: var(--primary);
        box-shadow: var(--shadow-md), 0 0 15px var(--primary-glow);
    }

    .card-img {
        width: 100%;
        height: 200px;
        object-fit: cover;
        transition: transform 0.5s ease;
    }

    .card:hover .card-img { transform: scale(1.05); }

    .card-body { padding: 1.25rem; }

    .card-tag {
        font-size: 0.7rem;
        font-weight: 700;
        color: var(--secondary);
        text-transform: uppercase;
        margin-bottom: 0.5rem;
        display: block;
    }

    /* Bot√£o Favorito - Animado */
    .fav-btn {
        position: absolute;
        top: 12px;
        right: 12px;
        z-index: 10;
        background: rgba(0,0,0,0.5);
        border: none;
        color: var(--text-main);
        width: 36px;
        height: 36px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: var(--transition);
        backdrop-filter: blur(4px);
    }

    .fav-btn:hover { transform: scale(1.1); background: rgba(0,0,0,0.7); }
    .fav-btn.active { color: #f43f5e; background: rgba(255,255,255,0.9); }

    /* ==========================================================================
    MODAIS E DETALHES DO POST - MAIS LAPIDADOS
    ========================================================================== */
    .modal {
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.75);
        backdrop-filter: blur(10px);
        z-index: 2000;
        overflow-y: auto;
        align-items: center;
        justify-content: center;
        transition: opacity 0.3s ease;
    }

    .modal.active { display: flex; opacity: 1; }

    .modal-content {
        background: #111827;
        width: 90%;
        max-width: 900px;
        margin: auto;
        border-radius: var(--radius);
        border: 1px solid var(--border);
        position: relative;
        box-shadow: var(--shadow-md);
        overflow: hidden;
        animation: modalScaleIn 0.3s ease-out;
    }

    @keyframes modalScaleIn {
        from { opacity: 0; transform: scale(0.95); }
        to { opacity: 1; transform: scale(1); }
    }

    .close-x {
        position: absolute;
        top: 16px;
        right: 16px;
        background: transparent;
        border: none;
        color: var(--text-muted);
        font-size: 1.5rem;
        cursor: pointer;
        transition: var(--transition);
    }

    .close-x:hover { color: #ef4444; transform: scale(1.1); }

    .post-banner { width: 100%; height: 400px; object-fit: cover; }
    .post-body { padding: 2.5rem; }

    /* Markdown Styling - Mais clean */
    .markdown-content { margin: 1.5rem 0; font-size: 1rem; line-height: 1.75; }
    .markdown-content h3 { color: var(--text-main); margin: 1.5rem 0 1rem; border-bottom: 1px solid var(--border); padding-bottom: 0.5rem; }
    .markdown-content code { background: rgba(255,255,255,0.05); padding: 2px 6px; border-radius: 4px; font-size: 0.9em; }
    .markdown-content ul { padding-left: 1.25rem; margin-bottom: 1.25rem; list-style-type: disc; }

    /* ==========================================================================
    FORMUL√ÅRIOS E BOT√ïES - MAIS PROFISSIONAIS
    ========================================================================== */
    .dash-container {
        max-width: 800px;
        margin: 2rem auto;
        background: var(--card-bg);
        padding: 2.5rem;
        border-radius: var(--radius);
        border: 1px solid var(--border);
        box-shadow: var(--shadow-sm);
    }

    .dash-form { display: flex; flex-direction: column; gap: 1.25rem; }

    .form-group label {
        display: block;
        font-size: 0.85rem;
        font-weight: 500;
        color: var(--text-main);
        margin-bottom: 0.5rem;
    }

    .dash-form input, .dash-form select, .dash-form textarea {
        width: 100%;
        padding: 0.875rem;
        border-radius: 8px;
        background: #1f2937;
        border: 1px solid var(--border);
        color: var(--text-main);
        font-family: inherit;
        transition: var(--transition);
    }

    .dash-form input:focus, .dash-form textarea:focus, .dash-form select:focus {
        border-color: var(--primary);
        outline: none;
        box-shadow: 0 0 0 2px var(--primary-glow);
    }

    .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 1.25rem; }

    .btn-primary {
        background: linear-gradient(135deg, var(--primary), #5b21b6);
        color: white;
        border: none;
        padding: 0.875rem 1.75rem;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        transition: var(--transition);
        text-decoration: none;
    }

    .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 12px rgba(124, 58, 237, 0.3);
    }

    .btn-primary:active { transform: translateY(0); }

    .btn-danger {
        background: linear-gradient(135deg, #ef4444, #dc2626);
        color: white;
        border: none;
        padding: 0.875rem 1.75rem;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        transition: var(--transition);
        text-decoration: none;
    }

    .btn-danger:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 12px rgba(239, 68, 68, 0.3);
    }

    .btn-danger:active { transform: translateY(0); }

    .btn-edit {
        background: linear-gradient(135deg, #eab308, #ca8a04);
        color: white;
        border: none;
        padding: 0.625rem 1.25rem;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 500;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        transition: var(--transition);
        margin-right: 0.75rem;
    }

    .btn-edit:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(234, 179, 8, 0.3);
    }

    .btn-delete {
        background: linear-gradient(135deg, #ef4444, #dc2626);
        color: white;
        border: none;
        padding: 0.625rem 1.25rem;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 500;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        transition: var(--transition);
    }

    .btn-delete:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(239, 68, 68, 0.3);
    }

    /* ==========================================================================
    SISTEMA DE TOASTS E FEEDBACK - MAIS SUAVE
    ========================================================================== */
    #toast-container { position: fixed; bottom: 40px; right: 40px; z-index: 9999; }

    .toast {
        padding: 1rem 2rem;
        border-radius: 8px;
        color: white;
        margin-top: 10px;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 10px;
        box-shadow: var(--shadow-md);
        animation: toastIn 0.3s ease-out;
        min-width: 250px;
    }

    @keyframes toastIn {
        from { transform: translateX(50px); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
    }

    .loading-state {
        grid-column: 1 / -1;
        text-align: center;
        padding: 3rem;
        color: var(--text-muted);
        font-size: 1.1rem;
    }

    /* ==========================================================================
    FOOTER - APRIMORADO
    ========================================================================== */
    footer {
        background: rgba(10, 10, 15, 0.95);
        backdrop-filter: blur(20px);
        border-top: 1px solid var(--border);
        padding: 2.5rem 0;
        text-align: center;
        color: var(--text-muted);
        font-size: 0.85rem;
        box-shadow: var(--shadow-sm);
    }

    footer a {
        color: var(--primary);
        text-decoration: none;
        transition: var(--transition);
    }

    footer a:hover {
        color: var(--secondary);
    }

    footer .footer-links {
        display: flex;
        justify-content: center;
        gap: 1.75rem;
        margin-bottom: 1rem;
        font-weight: 500;
    }

    /* ==========================================================================
    RESPONSIVIDADE - MAIS FLUIDA
    ========================================================================== */
    @media (max-width: 768px) {
        .navbar { padding: 1rem 2rem; }
        .grid-2 { grid-template-columns: 1fr; }
        .hero { padding: 4rem 1rem; }
        .post-body { padding: 2rem 1.5rem; }
        .post-banner { height: 300px; }
        .modal-content { width: 95%; }
        .content-grid { grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); }
    }
</style>
<body>

    <div id="toast-container"></div>

    <nav class="navbar">
        <div class="logo">
            R36S Hub
        </div>
        <ul class="nav-links">
            <li><a href="#" id="view-home" class="active">Explorar</a></li>
            <li id="nav-dashboard" style="display: none;"><a href="#" id="view-dash">Contribuir</a></li>
        </ul>
        <div class="hamburger" id="hamburger">
            <span></span><span></span><span></span>
        </div>
        <div id="auth-controls">
            <button id="btn-login-open" class="btn-primary">
                <i class="ph-user"></i> <span>Entrar</span>
            </button>
            <button id="btn-logout" class="btn-danger" style="display: none;">
                <i class="ph-sign-out"></i> Sair
            </button>
        </div>
    </nav>

    <main class="container">
        
        <section id="section-home">
            <header class="hero">
                <h1>O melhor do <span class="gradient-text">R36S</span></h1>
                <p>Biblioteca de temas, guias e firmwares pela comunidade.</p>
                
                <div class="search-bar">
                    <i class="ph-magnifying-glass"></i>
                    <input type="text" id="searchInput" placeholder="Pesquisar temas ou guias...">
                </div>
            </header>
            
            <div class="filters">
                <button class="filter-chip active" data-cat="all">Todos</button>
                <button class="filter-chip" data-cat="theme">Temas</button>
                <button class="filter-chip" data-cat="tutorial">Tutoriais</button>
                <button class="filter-chip" id="filter-favs">
                <i class="ph-heart-fill"></i> Salvos
                </button>
            </div>

            <section id="content-grid" class="content-grid"></section>
        </section>

        <section id="section-dashboard" style="display: none;">
            <div class="dash-container">
                <h2 class="gradient-text" id="dash-title">Nova Contribui√ß√£o</h2>
                <form id="form-contribute" class="dash-form">
                    <input type="hidden" id="item-id">
                    <div class="form-group">
                        <label>T√≠tulo do Projeto</label>
                        <input type="text" id="item-title" placeholder="Ex: Crystal OS Dark" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Categoria</label>
                        <select id="item-type">
                            <option value="theme">Tema</option>
                            <option value="tutorial">Tutorial / Guia</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Descri√ß√£o Curta (Card)</label>
                        <textarea id="item-desc" rows="2" placeholder="Uma breve introdu√ß√£o..." required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Conte√∫do Detalhado (Markdown Suportado)</label>
                        <textarea id="item-content" style="height: 250px;" placeholder="Escreva o seu guia aqui..."></textarea>
                    </div>
                    
                    <div class="grid-2">
                        <div class="form-group">
                            <label>URL da Imagem (Capa)</label>
                            <input type="url" id="item-thumb" placeholder="https://imgur.com/..." required>
                        </div>
                        <div class="form-group">
                            <label>ID do V√≠deo YouTube (Opcional)</label>
                            <input type="text" id="item-video" placeholder="Ex: dQw4w9WgXcQ">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Link de Download</label>
                        <input type="url" id="item-link" placeholder="GitHub, Mega, etc." required>
                    </div>
                    
                    <button type="submit" class="btn-primary" style="width: 100%; justify-content: center; padding: 1.2rem;" id="btn-submit-post">
                        <i class="ph-paper-plane-tilt"></i> Publicar no Hub
                    </button>
                </form>
            </div>
            <!-- Nova se√ß√£o para posts do usu√°rio -->
            <div class="dash-container" id="user-posts" style="display: none;">
                <h2 class="gradient-text">Seus Posts</h2>
                <div id="user-posts-list"></div>
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-links">
            <a href="#">Sobre</a>
            <a href="#">Contato</a>
            <a href="#">Termos de Uso</a>
            <a href="#">Privacidade</a>
        </div>
        <p>&copy; 2026 R36S Hub. Criado por <a href="https://mateuscalixto.com.br">Mateus Calixto</a>. Todos os direitos reservados.</p>
    </footer>

    <div id="post-modal" class="modal">
        <div class="modal-content post-detail">
            <button id="btn-close-post" class="close-x">
                <i class="ph-x"></i>
            </button>
            <div id="post-content-area">
                </div>
        </div>
    </div>

    <div id="auth-modal" class="modal">
        <div class="modal-content" style="max-width: 400px; padding: 2.5rem;">
            <h2 id="auth-title" class="pixel-font" style="margin-bottom: 0.5rem;">Login</h2>
            <p id="auth-subtitle" style="color: var(--text-muted); font-size: 0.85rem; margin-bottom: 2rem;">
                Aceda √† sua conta para gerir publica√ß√µes.
            </p>
            
            <div class="dash-form">
                <div class="form-group">
                    <input type="email" id="auth-email" placeholder="E-mail">
                </div>
                <div class="form-group">
                    <input type="password" id="auth-pass" placeholder="Palavra-passe">
                </div>
                <button id="btn-auth-confirm" class="btn-primary" style="width: 100%; justify-content: center;">
                    Confirmar
                </button>
                <button id="btn-auth-toggle" class="btn-link" style="background:none; border:none; color:var(--primary); cursor:pointer; font-size: 0.8rem; margin-top: 10px;">
                    N√£o tem conta? Registe-se
                </button>
                <button id="btn-auth-close" style="background:transparent; border:none; color: #555; cursor:pointer; margin-top: 15px;">
                    Cancelar
                </button>
            </div>
        </div>
    </div>

    <script type="module">
        // ==========================================================================
        // CONFIGURA√á√ÉO E IMPORTA√á√ïES DO FIREBASE
        // ==========================================================================
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, collection, getDocs, addDoc, query, serverTimestamp, orderBy, limit, startAfter, where, updateDoc, deleteDoc, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBG5BLxR02T6jO8yX9smrELRudlIV1vDOw",
            authDomain: "r36s-97621.firebaseapp.com",
            projectId: "r36s-97621",
            storageBucket: "r36s-97621.firebasestorage.app",
            messagingSenderId: "77809018203",
            appId: "1:77809018203:web:aba6d9dd8b7b523cfd667e"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        // ==========================================================================
        // UTILIT√ÅRIOS E UI
        // ==========================================================================

        // Sistema de Notifica√ß√µes (Toasts)
        function notify(msg, type = 'success') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast`;
            toast.style.background = type === 'success' ? '#10b981' : (type === 'info' ? '#3b82f6' : '#ef4444');
            toast.innerHTML = `<i class="ph-info-bold"></i> ${msg}`;
            container.appendChild(toast);
            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Template padr√£o para novos tutoriais
        const tutorialTemplate = `### üìã Requisitos
* Cart√£o SD Original (SanDisk/Samsung)
* Firmware ArkOS/RetroOz atualizado

### üöÄ Passo a Passo
1. Primeiro passo detalhado aqui...
2. Configure as seguintes op√ß√µes no menu...

### ‚ö†Ô∏è Notas Importantes
> Nunca desligue o console durante o processo de flash!`;

        // ==========================================================================
        // GEST√ÉO DE FAVORITOS (LocalStorage)
        // ==========================================================================

        function getFavs() {
            return JSON.parse(localStorage.getItem('r36s_favs') || '[]');
        }

        function toggleFav(id, event) {
            if (event) event.stopPropagation();
            let favs = getFavs();
            const index = favs.indexOf(id);

            if (index > -1) {
                favs.splice(index, 1);
                notify("Removido dos favoritos", "info");
            } else {
                favs.push(id);
                notify("Guardado nos favoritos!", "success");
            }

            localStorage.setItem('r36s_favs', JSON.stringify(favs));
            
            // Re-renderizar se necess√°rio
            const currentActiveFilter = document.querySelector('.filter-chip.active');
            fetchContent(currentActiveFilter.dataset.cat, document.getElementById('searchInput').value, currentActiveFilter.id === 'filter-favs');
        }

        // ==========================================================================
        // MOTOR DE DADOS: BUSCA E RENDERIZA√á√ÉO
        // ==========================================================================

        let lastDoc = null;

        async function fetchContent(category = 'all', term = '', onlyFavs = false, loadMore = false) {
            const grid = document.getElementById('content-grid');
            if (!loadMore) {
                grid.innerHTML = '<div class="loading-state">A sintonizar o Hub...</div>';
                lastDoc = null;
            }
            
            try {
                let q = query(collection(db, "resources"), orderBy("createdAt", "desc"), limit(10));
                if (lastDoc && loadMore) q = query(q, startAfter(lastDoc));
                const snap = await getDocs(q);
                lastDoc = snap.docs[snap.docs.length - 1];

                const favs = getFavs();
                if (!loadMore) grid.innerHTML = '';

                let count = 0;

                snap.forEach(doc => {
                    const data = doc.data();
                    const id = doc.id;
                    
                    // Busca avan√ßada em m√∫ltiplos campos
                    const searchStr = `${data.title} ${data.description} ${data.content || ''}`.toLowerCase();
                    if (term && !searchStr.includes(term.toLowerCase())) return;
                    if (category !== 'all' && data.type !== category) return;
                    if (onlyFavs && !favs.includes(id)) return;

                    count++;
                    const isFav = favs.includes(id);

                    const card = document.createElement('article');
                    card.className = 'card';
                    card.innerHTML = `
                        <button class="fav-btn ${isFav ? 'active' : ''}" title="Favoritar" aria-label="Favoritar post">
                            <i class="ph-heart-fill"></i>
                        </button>
                        <img src="${data.thumbnailUrl}" class="card-img" alt="Capa de ${data.title}" onerror="this.src='https://placehold.co/600x400/161b22/FFF?text=R36S+Hub'">
                        <div class="card-body">
                            <span class="card-tag">${data.type}</span>
                            <h3>${data.title}</h3>
                            <p style="font-size: 0.85rem; color: var(--text-muted); line-height: 1.4;">${data.description.substring(0, 80)}...</p>
                        </div>
                    `;

                    // Eventos do Card
                    card.querySelector('.fav-btn').onclick = (e) => toggleFav(id, e);
                    card.onclick = () => openPost(data);
                    grid.appendChild(card);
                });

                // Bot√£o Load More
                if (snap.size === 10 && !document.getElementById('load-more-btn')) {
                    const loadBtn = document.createElement('button');
                    loadBtn.id = 'load-more-btn';
                    loadBtn.className = 'btn-primary';
                    loadBtn.style.margin = '2rem auto';
                    loadBtn.style.display = 'block';
                    loadBtn.innerText = 'Carregar Mais';
                    loadBtn.onclick = () => {
                        fetchContent(category, term, onlyFavs, true);
                        loadBtn.remove();
                    };
                    grid.appendChild(loadBtn);
                }

                if (count === 0 && !loadMore) {
                    grid.innerHTML = '<div class="loading-state">Nenhum resultado encontrado nesta categoria.</div>';
                }

            } catch (err) { 
                console.error(err);
                notify("Erro ao carregar dados do Firebase: " + err.message, "error");
            }
        }

        function openPost(data) {
            const area = document.getElementById('post-content-area');
            
            // Tratamento de V√≠deo YouTube melhorado
            let videoHTML = '';
            if (data.videoUrl) {
                const match = data.videoUrl.match(/(?:youtube(?:-nocookie)?\.com\/(?:[^\/\n\s]+\/\S+|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/);
                const videoId = match ? match[1] : data.videoUrl;
                videoHTML = `
                    <div class="post-video" style="position:relative; padding-bottom:56.25%; height:0; margin: 2rem 0; overflow:hidden; border-radius:12px;">
                        <iframe style="position:absolute; top:0; left:0; width:100%; height:100%;" 
                        src="https://www.youtube.com/embed/${videoId}" frameborder="0" allowfullscreen></iframe>
                    </div>`;
            }
            
            area.innerHTML = `
                <img src="${data.thumbnailUrl}" class="post-banner" alt="Banner de ${data.title}" onerror="this.src='https://placehold.co/1200x600/161b22/FFF?text=R36S+Hub'">
                <div class="post-body">
                    <span class="pixel-font">${data.type}</span>
                    <h1 style="margin: 10px 0 5px 0;">${data.title}</h1>
                    <p style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 2rem;">Contribu√≠do por: <strong>${data.authorName || 'Membro do Hub'}</strong></p>
                    
                    <div class="markdown-content">${marked.parse(data.content || '*Sem detalhes adicionais.*')}</div>
                    
                    ${videoHTML}
                    
                    <a href="${data.link}" target="_blank" class="btn-primary" style="justify-content:center; text-decoration:none; padding: 1.2rem; margin-top: 2rem; width: 100%;">
                        <i class="ph-download-simple"></i> Download / Aceder Recurso
                    </a>
                </div>
            `;
            document.getElementById('post-modal').style.display = 'flex';
        }

        // ==========================================================================
        // EVENTOS DE NAVEGA√á√ÉO E AUTENTICA√á√ÉO
        // ==========================================================================

        // Alternar entre abas (In√≠cio / Dashboard)
        const showView = (view) => {
            document.getElementById('section-home').style.display = view === 'home' ? 'block' : 'none';
            document.getElementById('section-dashboard').style.display = view === 'dash' ? 'block' : 'none';
            
            // Atualiza estado ativo nos links da nav
            document.getElementById('view-home').classList.toggle('active', view === 'home');
            document.getElementById('view-dash').classList.toggle('active', view === 'dash');
            
            if(view === 'home') fetchContent();
            if(view === 'dash') {
                resetForm();
                loadUserPosts();
            }
        };

        document.getElementById('view-home').onclick = (e) => { e.preventDefault(); showView('home'); };
        document.getElementById('view-dash').onclick = (e) => { e.preventDefault(); showView('dash'); };

        // Hamburger Toggle
        document.getElementById('hamburger').onclick = () => {
            const navLinks = document.querySelector('.nav-links');
            navLinks.classList.toggle('active');
            document.getElementById('hamburger').classList.toggle('active');
        };

        // Login / Registo
        let isLoginMode = true;
        const authModal = document.getElementById('auth-modal');

        document.getElementById('btn-auth-toggle').onclick = () => {
            isLoginMode = !isLoginMode;
            document.getElementById('auth-title').innerText = isLoginMode ? "Entrar" : "Criar Conta";
            document.getElementById('btn-auth-confirm').innerText = isLoginMode ? "Entrar" : "Registar";
            document.getElementById('btn-auth-toggle').innerText = isLoginMode ? "N√£o tem conta? Registe-se" : "J√° tem conta? Login";
        };

        document.getElementById('btn-auth-confirm').onclick = async () => {
            const email = document.getElementById('auth-email').value;
            const pass = document.getElementById('auth-pass').value;
            
            if(!email || !pass) return notify("Preencha todos os campos", "error");

            try {
                if (isLoginMode) {
                    await signInWithEmailAndPassword(auth, email, pass);
                    notify("Sess√£o iniciada!");
                } else {
                    await createUserWithEmailAndPassword(auth, email, pass);
                    notify("Conta criada com sucesso!");
                }
                authModal.style.display = 'none';
            } catch (e) {
                notify("Erro: Verifique as suas credenciais.", "error");
            }
        };

        // Monitor de estado do Utilizador
        onAuthStateChanged(auth, user => {
            document.getElementById('nav-dashboard').style.display = user ? 'block' : 'none';
            document.getElementById('btn-login-open').style.display = user ? 'none' : 'block';
            document.getElementById('btn-logout').style.display = user ? 'block' : 'none';
            document.getElementById('user-posts').style.display = user ? 'block' : 'none';
        });

        // Fechar Modais
        document.getElementById('btn-login-open').onclick = () => authModal.style.display = 'flex';
        document.getElementById('btn-auth-close').onclick = () => authModal.style.display = 'none';
        document.getElementById('btn-close-post').onclick = () => document.getElementById('post-modal').style.display = 'none';
        document.getElementById('btn-logout').onclick = () => {
            signOut(auth);
            showView('home');
            notify("Sess√£o terminada", "info");
        };

        // Fechar modal ao clicar fora dele
        window.onclick = (event) => {
            if (event.target == authModal) authModal.style.display = "none";
            if (event.target == document.getElementById('post-modal')) document.getElementById('post-modal').style.display = "none";
        };

        // ==========================================================================
        // FILTROS E PESQUISA
        // ==========================================================================

        let debounceTimer;
        document.getElementById('searchInput').oninput = (e) => {
            clearTimeout(debounceTimer);
            debounceTimer = setTimeout(() => {
                fetchContent('all', e.target.value);
            }, 300); // Debounce para performance
        };

        document.querySelectorAll('.filter-chip').forEach(chip => {
            chip.onclick = () => {
                if(chip.id === 'filter-favs') {
                    document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
                    chip.classList.add('active');
                    fetchContent('all', '', true);
                    return;
                }
                document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
                chip.classList.add('active');
                fetchContent(chip.dataset.cat);
            };
        });

        // Template Autom√°tico
        document.getElementById('item-type').onchange = (e) => {
            const content = document.getElementById('item-content');
            if (e.target.value === 'tutorial' && !content.value) {
                content.value = tutorialTemplate;
                notify("Template de tutorial aplicado", "info");
            }
        };

        // ==========================================================================
        // SUBMISS√ÉO E EDI√á√ÉO DE CONTE√öDO
        // ==========================================================================

        function validateForm() {
            const title = document.getElementById('item-title').value;
            const thumb = document.getElementById('item-thumb').value;
            const link = document.getElementById('item-link').value;
            let video = document.getElementById('item-video').value;

            if (!title) {
                notify("T√≠tulo √© obrigat√≥rio", "error");
                return false;
            }
            if (!thumb.match(/^https?:\/\/.+\.(jpg|png|gif|jpeg)$/i)) {
                notify("URL de imagem inv√°lida (deve ser jpg, png ou gif)", "error");
                return false;
            }
            if (!link.match(/^https?:\/\/.+/i)) {
                notify("Link de download inv√°lido", "error");
                return false;
            }
            if (video) {
                const match = video.match(/(?:youtube(?:-nocookie)?\.com\/(?:[^\/\n\s]+\/\S+|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/);
                if (!match) {
                    notify("ID de v√≠deo YouTube inv√°lido", "error");
                    return false;
                }
                video = match[1]; // Atualiza para ID puro
            }
            return true;
        }

        function resetForm() {
            document.getElementById('form-contribute').reset();
            document.getElementById('item-id').value = '';
            document.getElementById('dash-title').innerText = 'Nova Contribui√ß√£o';
            document.getElementById('btn-submit-post').innerHTML = `<i class="ph-paper-plane-tilt"></i> Publicar no Hub`;
        }

        document.getElementById('form-contribute').onsubmit = async (e) => {
            e.preventDefault();
            if (!validateForm()) return;

            const btn = document.getElementById('btn-submit-post');
            btn.disabled = true;
            btn.innerText = "Processando...";

            const id = document.getElementById('item-id').value;
            const data = {
                title: document.getElementById('item-title').value,
                type: document.getElementById('item-type').value,
                description: document.getElementById('item-desc').value,
                content: document.getElementById('item-content').value,
                thumbnailUrl: document.getElementById('item-thumb').value,
                videoUrl: document.getElementById('item-video').value,
                link: document.getElementById('item-link').value,
                authorName: auth.currentUser.email.split('@')[0]
            };

            try {
                if (id) {
                    await updateDoc(doc(db, "resources", id), data);
                    notify("Post atualizado com sucesso!");
                } else {
                    data.createdAt = serverTimestamp();
                    await addDoc(collection(db, "resources"), data);
                    notify("Publicado com sucesso no Hub!");
                }
                resetForm();
                loadUserPosts();
                showView('home');
            } catch (err) {
                notify("Erro ao processar conte√∫do: " + err.message, "error");
            } finally {
                btn.disabled = false;
                btn.innerHTML = id ? `<i class="ph-pencil-simple"></i> Atualizar Post` : `<i class="ph-paper-plane-tilt"></i> Publicar no Hub`;
            }
        };

        // ==========================================================================
        // CARREGAR POSTS DO USU√ÅRIO PARA EDI√á√ÉO/EXCLUS√ÉO
        // ==========================================================================

        async function loadUserPosts() {
            if (!auth.currentUser) return;
            const userPostsList = document.getElementById('user-posts-list');
            userPostsList.innerHTML = '<div class="loading-state">Carregando seus posts...</div>';

            try {
                const q = query(collection(db, "resources"), where("authorName", "==", auth.currentUser.email.split('@')[0]), orderBy("createdAt", "desc"));
                const snap = await getDocs(q);
                userPostsList.innerHTML = '';

                if (snap.empty) {
                    userPostsList.innerHTML = '<p style="text-align: center; color: var(--text-muted);">Voc√™ ainda n√£o tem posts.</p>';
                    return;
                }

                snap.forEach(doc => {
                    const data = doc.data();
                    const id = doc.id;
                    const postItem = document.createElement('div');
                    postItem.style.marginBottom = '1rem';
                    postItem.style.padding = '1rem';
                    postItem.style.border = '1px solid var(--border)';
                    postItem.style.borderRadius = '12px';
                    postItem.innerHTML = `
                        <h3>${data.title}</h3>
                        <p>${data.description.substring(0, 50)}...</p>
                        <button class="btn-edit" onclick="editPost('${id}')"><i class="ph-pencil-simple"></i> Editar</button>
                        <button class="btn-delete" onclick="deletePost('${id}')"><i class="ph-trash"></i> Excluir</button>
                    `;
                    userPostsList.appendChild(postItem);
                });
            } catch (err) {
                notify("Erro ao carregar seus posts: " + err.message, "error");
            }
        }

        // Fun√ß√£o de Edi√ß√£o
        window.editPost = async (id) => {
            try {
                const postDoc = await getDoc(doc(db, "resources", id));
                if (postDoc.exists()) {
                    const data = postDoc.data();
                    document.getElementById('item-id').value = id;
                    document.getElementById('item-title').value = data.title;
                    document.getElementById('item-type').value = data.type;
                    document.getElementById('item-desc').value = data.description;
                    document.getElementById('item-content').value = data.content;
                    document.getElementById('item-thumb').value = data.thumbnailUrl;
                    document.getElementById('item-video').value = data.videoUrl;
                    document.getElementById('item-link').value = data.link;
                    document.getElementById('dash-title').innerText = 'Editar Contribui√ß√£o';
                    document.getElementById('btn-submit-post').innerHTML = `<i class="ph-pencil-simple"></i> Atualizar Post`;
                    notify("Modo de edi√ß√£o ativado.", "info");
                } else {
                    notify("Post n√£o encontrado.", "error");
                }
            } catch (err) {
                notify("Erro ao carregar post para edi√ß√£o: " + err.message, "error");
            }
        };

        window.deletePost = async (id) => {
            if (!confirm("Tem certeza que deseja excluir este post?")) return;
            try {
                await deleteDoc(doc(db, "resources", id));
                notify("Post exclu√≠do com sucesso!", "success");
                loadUserPosts();
            } catch (err) {
                notify("Erro ao excluir post: " + err.message, "error");
            }
        };

        // Inicializa√ß√£o
        fetchContent();
    </script>
</body>
</html>